<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="cache-control" content="no-cache">
<meta http-equiv="expires" content="0">
<meta http-equiv="Content-Style-Type" content="text/css" />
<meta http-equiv="Content-Script-Type" content="text/javascript" />
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.1/css/all.css" />
<link rel="stylesheet" href="https://ft1.mendoff.jp/css/firstteam.css" />
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js"></script>
<script src="https://static.line-scdn.net/liff/edge/2.1/sdk.js"></script>
<script type="text/javascript" src="https://www.google.com/jsapi"></script>
<script src="https://ft1.mendoff.jp/js/jquery.japan-map.min.js"></script>
<script src="https://ajaxzip3.github.io/ajaxzip3.js" charset="UTF-8"></script>
<script>
var WebSafeBase64 = {
  encode: function(str) {
    var s = str.replace(/\+/g, '-').replace(/\//g, '_');
    return btoa(unescape(encodeURIComponent(s)));
  },
  decode: function(str) {
    var s = str.replace(/\-/g, '+').replace(/_/g , '/').replace(/%3D/g, '=');
    return decodeURIComponent(escape(atob(s)));
  }
};
jQuery(function() {
  try {
    var key = location.search.substring(1).slice(4);
    if (key) {
      json = JSON.parse(WebSafeBase64.decode(key));
      liff.init({
        liffId: json.liffId
      }, (data) => {
        $(function(){
          let contents = "";
          switch(json.keyword) {
            case "STEP1":
              contents = "step1.html";
              break;
            case "STEP3":
              contents = "step3.html";
              break;
            case "STEP4":
              contents = "step4.html";
              break;
            case "STEP5":
              contents = "step5.html";
              break;
            case "STEP7":
              contents = "step7.html";
              break;
            case "STEP8A":
              contents = "step8A.html";
              break;
            case "STEP8B":
              contents = "step8B.html";
              break;
            case "STEP8C":
              contents = "step8C.html";
              break;
            case "STEP9":
              contents = "step9.html";
              break;
            case "STEP13":
              contents = "step13.html";
              break;
            case "SIMULATION1":
              contents = "simulation1.html";
              break;
            case "SIMULATION4B":
              contents = "simulation4B.html";
              break;
            case "SIMULATION4A1":
              contents = "simulation4A1.html";
              break;
            case "SIMULATION4A2":
              contents = "simulation4A2.html";
              break;
            case "SIMULATION4A3":
              contents = "simulation4A3.html";
              break;
            default:
              contents = "input.html";
              break;
          }
          $("#contents").load(contents, function() {
            $("#keyword").text(json.keyword);
            var p = {};
            if (json.parameter) {
              try {
                var param = JSON.parse(WebSafeBase64.decode(json.parameter));
                Object.keys(param).forEach(function(v) {
                  let val = WebSafeBase64.decode(param[v]);
                  $("#" + v).val(val);
                  p[v] = val;
                });
              } catch(ex) {
                alert(ex);
              }
            }
            if (json.keyword == "STEP1") {
              makeStep1();
            }
            if (json.keyword == "STEP3") {
              makeStep3();
            }
            if (json.keyword == "STEP4") {
              makeStep4();
            }
            if (json.keyword == "STEP5") {
              makeStep5();
            }
            if (json.keyword == "STEP7") {
              makeStep7();
            }
            if (json.keyword == "STEP8A") {
              makeStep8A();
            }
            if (json.keyword == "STEP8B") {
              makeStep8B();
            }
            if (json.keyword == "STEP8C") {
              makeStep8C();
            }
            if (json.keyword == "STEP9") {
              makeStep9();
            }
            if (json.keyword == "STEP13") {
              makeStep13();
            }
            if (json.keyword == "SIMULATION1") {
              makeSimulation1();
            }
            if (json.keyword == "SIMULATION4B") {
              makeSimulation4B();
            }
            if (json.keyword == "SIMULATION4A1") {
              makeSimulation4A1();
            }
            if (json.keyword == "SIMULATION4A2") {
              makeSimulation4A2();
            }
            if (json.keyword == "SIMULATION4A3") {
              makeSimulation4A3();
            }
          });
        });
      });
    }
  } catch(ex) {
    alert(ex);
  }
});
</script>
<style type="text/css">
.big { font-size:14pt; }
</style>
<title>項目の入力</title>
</head>
<body>
<div class="container">
  <div id="contents"></div>
</div>
</body>
</html>
