<!-- 電気料金プラン:kandenpd.html start -->
  <div class="row">
    &nbsp;
  </div>
  <span id="keyword" style="display: none;"></span>
  <div style="font-size: 14pt;">
    現在ご利用中の電気料金プランを選択してください
  </div>
  <div class="row">
    &nbsp;
  </div>
  <div class="row">
    <div class="col-sm-1"><font size="5"></font></div>
    <div class="col-sm-11">
      <select id="plan" class="form-control">
        <option value="">選択してください</option>
        <option value="従量電灯A">従量電灯A</option>
        <option value="従量電灯B">従量電灯B</option>
        <option value="低圧電力">低圧電力</option>
        <option value="はぴeタイム">はぴeタイム</option>
        <option value="はぴeタイムR">はぴeタイムR</option>
        <option value="eスマート10">eスマート10</option>
        <option value="eおとくプラン">eおとくプラン</option>
        <option value="時間帯別電灯">時間帯別電灯</option>
        <option value="季時別電灯PS">季時別電灯PS</option>
        <option value="なっトクでんき">なっトクでんき</option>
        <option value="なっトクでんきBiz">なっトクでんきBiz</option>
      </select>
    </div>
  </div>
  <div id="dispCapacity">
    <div class="row">
      &nbsp;
    </div>
    <div style="font-size: 14pt;">
      ご契約容量を選択してください<br>
      (単位：<span  id="capacityUnit"></span>)
    </div>
    <div class="row">
      <div class="col-sm-1"><font size="5"></font></div>
      <div class="col-sm-11">
        <select id="capacity" class="form-control">
          <option value="">選択してください</option>
          <option value="6">6</option>
          <option value="7">7</option>
          <option value="8">8</option>
          <option value="9">9</option>
          <option value="10">10</option>
          <option value="11">11</option>
          <option value="12">12</option>
          <option value="13">13</option>
          <option value="14">14</option>
          <option value="15">15</option>
          <option value="16">16</option>
          <option value="17">17</option>
          <option value="18">18</option>
          <option value="19">19</option>
          <option value="20">20</option>
          <option value="21">21</option>
          <option value="22">22</option>
          <option value="23">23</option>
          <option value="24">24</option>
          <option value="25">25</option>
          <option value="26">26</option>
          <option value="27">27</option>
          <option value="28">28</option>
          <option value="29">29</option>
          <option value="30">30</option>
          <option value="31">31</option>
          <option value="32">32</option>
          <option value="33">33</option>
          <option value="34">34</option>
          <option value="35">35</option>
          <option value="36">36</option>
          <option value="37">37</option>
          <option value="38">38</option>
          <option value="39">39</option>
          <option value="40">40</option>
          <option value="41">41</option>
          <option value="42">42</option>
          <option value="43">43</option>
          <option value="44">44</option>
          <option value="45">45</option>
          <option value="46">46</option>
          <option value="47">47</option>
          <option value="48">48</option>
          <option value="49">49</option>
        </select>
      </div>
    </div>
  </div>
  <div id="dispPowerFactor">
    <div class="row">
      &nbsp;
    </div>
    <div style="font-size: 14pt;">
      力率を選択してください
    </div>
    <div class="row">
      <div class="col-sm-12">
          <select id="powerFactor" class="form-control">
            <option value="">選択してください</option>
            <option value="90">90%</option>
            <option value="85">85%</option>
            <option value="80">80%</option>
          </select>
      </div>
    </div>
  </div>
  <div class="row">
    &nbsp;
  </div>
  <div class="row">
    <div class="col-sm-1"></div>
    <div class="col-sm-11">
      <button type="button" class="btn btn-lg btn-success" onClick="sendMsg();">決定</button>
    </div>
  </div>
  <div class="row">
    &nbsp;
  </div>
  <script>
    function sendMsg() {
      let msg = "";
      let capacity = "";
      let capacityUnit = "";
      let powerFactor = "";
      let plan = $("#plan").val();
      if (plan == "") {
        msg += "電気料金プランを選択してください\n";
      }
      if (plan == "従量電灯B" ||
          plan == "低圧電力" ||
          plan == "eスマート10" ||
          plan == "eおとくプラン" ||
          plan == "なっトクでんきBiz") {
        capacity = $("#capacity").val();
        capacityUnit = $("#capacityUnit").text();
        if (capacity == "") {
          msg += "ご契約容量を選択してください\n";
        }
        if (plan == "低圧電力") {
          powerFactor = $("#powerFactor").val();
          if (powerFactor == "") { 
            msg += "力率を選択してください\n";
          }
        }
      }
      if (msg) {
        alert(msg);
        return false;
      }
      var text = "入力-";
      text += $("#keyword").text() + ":";
      text += plan + "|";
      text += capacity + capacityUnit + "|";
      text += powerFactor + "|";
      liff.sendMessages([
        {
          "type": "text",
          "text":  text
        }
      ])
      .then(() => {
        liff.closeWindow();
      })
      .catch((err) => {
        alert(err);
        liff.closeWindow();
      });
    }
    // 契約容量のプルダウン連動
    function makeCapacity() {
      $('#plan').change(function() {
        $("#dispCapacity").hide();
        $("#dispPowerFactor").hide();
        switch($(this).val()) {
          case "従量電灯B":
            $("#capacityUnit").text("kVA");
            $("#dispCapacity").show();
            break;
          case "なっトクでんきBiz":
            $("#capacityUnit").text("kVA");
            $("#dispCapacity").show();
            break;
          case "eスマート10":
            $("#capacityUnit").text("kW");
            $("#dispCapacity").show();
            break;
          case "eおとくプラン":
            $("#capacityUnit").text("kW");
            $("#dispCapacity").show();
            break;
          case "低圧電力":
            $("#capacityUnit").text("kW");
            $("#dispCapacity").show();
            $("#dispPowerFactor").show();
            break;
        }
      });
      $('#plan').change();
    }
  </script>
<!-- 電気料金プラン:kandenpd.html end -->
